using UnityEngine;using System.Collections;using System.Collections.Generic;using SimpleJson;
public class MissionConfigData {
public const string NAME = "MissionConfig";
private string _data="[{\"id\":1,\"battleInfoId\":[1,1,1],\"title\":\"沙漠之旅\",\"desc\":\"第一章故事\",\"dialogueId\":[1,2,3],\"bgImg\":\"bg.jpg\"},{\"id\":2,\"battleInfoId\":[1,2,2],\"title\":\"迷路少女\",\"desc\":\"第二章故事\",\"dialogueId\":[],\"bgImg\":\"bg.jpg\"},{\"id\":3,\"battleInfoId\":[2,2,3],\"title\":\"迷路少女2\",\"desc\":\"第二章故事\",\"dialogueId\":[],\"bgImg\":\"bg.jpg\"},{\"id\":4,\"battleInfoId\":[2,3,4],\"title\":\"迷路少女3\",\"desc\":\"第二章故事\",\"dialogueId\":[],\"bgImg\":\"bg.jpg\"},{\"id\":5,\"battleInfoId\":[4,4,5],\"title\":\"迷路少女4\",\"desc\":\"第二章故事\",\"dialogueId\":[],\"bgImg\":\"bg.jpg\"},{\"id\":6,\"battleInfoId\":[5,5,5],\"title\":\"HIME学院\",\"desc\":\"第三章故事\",\"dialogueId\":[],\"bgImg\":\"bg.jpg\"}]";
private object[] _dataJson;private List<MissionConfig> _dataList=new List<MissionConfig>();
public MissionConfigData(){_dataJson = SimpleJson.SimpleJson.DeserializeObject<JsonArray> (_data).ToArray ();foreach (object jsonObject in _dataJson) {JsonObject jo=(JsonObject) jsonObject;MissionConfig config=new MissionConfig();_dataList.Add(config);foreach(string key in jo.Keys){object value=jo[key];System.Type type =typeof(MissionConfig);System.Reflection.FieldInfo info=type.GetField(key);if(info==null){continue;}if (value is JsonArray) {JsonArray jarr=(JsonArray)value;int jarrSize=jarr.Count;if(info.FieldType.FullName=="System.Int32[]"){int[] data=new int[jarrSize];for(int i=0;i<jarrSize;i++){data[i]= (int)jarr[i];}info.SetValue (config, data);}else{string[] data=new string[jarrSize];for(int i=0;i<jarrSize;i++){data[i]= (string)jarr[i];}info.SetValue (config, data);}}else{info.SetValue(config,value);}}}_dataJson = null;_data = null;}public List<MissionConfig> getList(){return _dataList;}}